package on_chain_tx

import MATIC_RPC_URL
import org.web3j.crypto.Credentials
import org.web3j.crypto.ECKeyPair
import org.web3j.protocol.core.JsonRpc2_0Web3j
import org.web3j.protocol.http.HttpService
import org.web3j.tx.RawTransactionManager
import java.math.BigInteger
import kotlin.system.exitProcess

fun main() {

    val web3service = HttpService(MATIC_RPC_URL)
    val web3 = JsonRpc2_0Web3j(web3service)

    val keys =
        ECKeyPair.create(BigInteger("73879472168346952077578437103592564545953740477884952342696959757500830031267"))
    // my address:  0x8cf1839B4e5eE89a31d3390eF5a0927918A5Da9A
    println(keys.privateKey)
    //val keys = Keys.createEcKeyPair()
    val creds = Credentials.create(keys)
    println(creds.address)
    val transactionManager = RawTransactionManager(web3, creds, 137)

//    val gasPrice = BigInteger.valueOf(22000000000L)
//    val gasLimit = BigInteger.valueOf(40000)
//    val value = BigInteger.valueOf(500000000)
//    val address = "0x03de2960E4Ee13F480CDf82F8106E77622C35DB0"
//    val data = "0x"

    val gasPrice = BigInteger.valueOf(3000000000L)
    val gasLimit = BigInteger.valueOf(173809)
    val value = BigInteger.valueOf(0)
    val address = "0x11111112542d85b3ef69ae05771c2dccff4faa26"
    val data = "0x7c02520000000000000000000000000011431a89893025d2a48dca4eddc396f8c8117187000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000d500b1d8e8ef31e21c99d1db9a6444d3adf12700000000000000000000000008f3cf7ad23cd3cadbd9735aff958023239c6a063000000000000000000000000eef611894ceae652979c9d0dae1deb597790c6ee0000000000000000000000008cf1839b4e5ee89a31d3390ef5a0927918a5da9a00000000000000000000000000000000000000000000000000000000000f42400000000000000000000000000000000000000000000000000000000000137a6e00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000a4b757fed6000000000000000000000000eef611894ceae652979c9d0dae1deb597790c6ee0000000000000000000000000d500b1d8e8ef31e21c99d1db9a6444d3adf12700000000000000000000000008f3cf7ad23cd3cadbd9735aff958023239c6a0630000000000000000002dc6c08cf1839b4e5ee89a31d3390ef5a0927918a5da9a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"

    val hash = transactionManager.sendTransaction(gasPrice, gasLimit, address, data, value).transactionHash
    println(hash)
    exitProcess(0)
}
